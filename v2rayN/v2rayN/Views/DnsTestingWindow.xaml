<base:WindowBase
    x:Class="v2rayN.Views.DnsTestingWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:base="clr-namespace:v2rayN.Base"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:reactiveui="http://reactiveui.net"
    xmlns:resx="clr-namespace:ServiceLib.Resx;assembly=ServiceLib"
    xmlns:vms="clr-namespace:ServiceLib.ViewModels;assembly=ServiceLib"
    Title="Ultra-Fast developer.android.com DNS Testing"
    Width="900"
    Height="700"
    x:TypeArguments="vms:SanctionsBypassViewModel"
    ShowInTaskbar="False"
    WindowStartupLocation="CenterScreen"
    mc:Ignorable="d">

    <DockPanel Margin="8">

        <!-- Header Section -->
        <StackPanel DockPanel.Dock="Top" Margin="0,0,0,16">
            <TextBlock
                Text="ðŸŽ¯ Developer.Android.Com DNS Testing Center"
                FontSize="20"
                FontWeight="Bold"
                HorizontalAlignment="Center"
                Foreground="DarkBlue" />
                                                <TextBlock
                Text="âš¡ Ultra-fast testing: ONLY developer.android.com access (3 seconds per DNS, 83 servers)"
                FontSize="14"
                HorizontalAlignment="Center"
                Margin="0,8,0,0"
                Foreground="Gray" />
            <TextBlock
                Text="ðŸ“Š Status: âœ… FULL ACCESS = Can bypass sanctions | âš ï¸ BLOCKED (DNS OK) = DNS works but sanctions applied | âŒ FAILED = DNS doesn't work"
                FontSize="11"
                HorizontalAlignment="Center"
                Margin="0,4,0,0"
                Foreground="DarkGray"
                TextWrapping="Wrap" />
        </StackPanel>
        
        <!-- Button Panel -->
        <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,16">
            <Button x:Name="btnTestAllDns" 
                    Content="ðŸ” Test All DNS Servers" 
                    Margin="0,0,8,0"
                    Padding="16,8"
                    Background="LightBlue"
                    Click="BtnTestAllDns_Click" />
            <Button x:Name="btnStopTest" 
                    Content="â¹ï¸ Stop Testing" 
                    Margin="8,0,8,0"
                    Padding="16,8"
                    Background="Orange"
                    IsEnabled="False"
                    Click="BtnStopTest_Click" />
            <Button x:Name="btnApplyOptimal"
                    Content="âœ… Apply Optimal DNS"
                    Margin="8,0,0,0"
                    Padding="16,8"
                    Background="LightGreen"
                    IsEnabled="False"
                    Click="BtnApplyOptimal_Click" />
            <Button x:Name="btnAdvancedBypass"
                    Content="ðŸš€ Advanced Bypass"
                    Margin="8,0,0,0"
                    Padding="16,8"
                    Background="Orange"
                    Click="BtnAdvancedBypass_Click" />
        </StackPanel>
        
        <!-- Progress Section -->
        <StackPanel DockPanel.Dock="Top" Margin="0,0,0,16" x:Name="progressPanel" Visibility="Collapsed">
            <TextBlock x:Name="txtProgress" 
                       Text="Preparing DNS testing..."
                       FontSize="14"
                       HorizontalAlignment="Center"
                       Margin="0,0,0,8" />
            <ProgressBar x:Name="progressBar" 
                         Height="6"
                         IsIndeterminate="False"
                         Value="0"
                         Maximum="83" />
        </StackPanel>
        
        <!-- Results Section -->
        <GroupBox Header="ðŸŽ¯ DNS Test Results" Margin="0,0,0,8">
            <DockPanel>
                
                <!-- Summary Panel -->
                <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,16">
                    <TextBlock x:Name="txtTotalTested" Text="Total: 0" Margin="0,0,16,0" FontSize="12" FontWeight="Bold" />
                    <TextBlock x:Name="txtWorkingCount" Text="Working: 0" Margin="0,0,16,0" FontSize="12" FontWeight="Bold" Foreground="Green" />
                    <TextBlock x:Name="txtFailedCount" Text="Failed: 0" Margin="0,0,16,0" FontSize="12" FontWeight="Bold" Foreground="Red" />
                    <TextBlock x:Name="txtOptimalDns" Text="Optimal: Not selected" FontSize="12" FontWeight="Bold" Foreground="Blue" />
                </StackPanel>
                
                <!-- Results DataGrid -->
                <DataGrid x:Name="dgResults"
                          AutoGenerateColumns="False"
                          CanUserAddRows="False"
                          CanUserDeleteRows="False"
                          CanUserReorderColumns="True"
                          CanUserResizeColumns="True"
                          CanUserSortColumns="True"
                          IsReadOnly="True"
                          GridLinesVisibility="Horizontal"
                          HeadersVisibility="Column"
                          VirtualizingPanel.IsVirtualizing="True"
                          VirtualizingPanel.VirtualizationMode="Recycling"
                          EnableRowVirtualization="True"
                          EnableColumnVirtualization="True"
                          ScrollViewer.CanContentScroll="True"
                          ScrollViewer.IsDeferredScrollingEnabled="True"
                          SelectionMode="Single"
                          SelectionUnit="FullRow"
                          Background="WhiteSmoke"
                          AlternatingRowBackground="AliceBlue"
                          RowHeight="22">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ðŸ† Rank" Binding="{Binding Rank}" Width="60" />
                        <DataGridTextColumn Header="ðŸ“¡ DNS Name" Binding="{Binding Name}" Width="140" />
                        <DataGridTextColumn Header="ðŸŒ IP Address" Binding="{Binding IpAddress}" Width="120" />
                        <DataGridTextColumn Header="âš¡ Response (ms)" Binding="{Binding ResponseTime}" Width="100" />
                        <DataGridTextColumn Header="âœ… Success Rate" Binding="{Binding SuccessRate}" Width="100" />
                        <DataGridTextColumn Header="ðŸŽ¯ developer.android.com" Binding="{Binding TestsPassed}" Width="140" />
                        <DataGridTextColumn Header="ðŸ“Š Tier" Binding="{Binding Tier}" Width="140" />
                        <DataGridTextColumn Header="âœ… Status" Binding="{Binding Status}" Width="100" />
                    </DataGrid.Columns>
                </DataGrid>
                
            </DockPanel>
        </GroupBox>
        
        <!-- Log Section -->
        <GroupBox Header="ðŸ“‹ Real-time Testing Log">
            <ScrollViewer x:Name="logScrollViewer" VerticalScrollBarVisibility="Auto">
                <TextBox x:Name="txtLog"
                         Text="Ready to test Iranian DNS servers..."
                         IsReadOnly="True"
                         TextWrapping="Wrap"
                         AcceptsReturn="True"
                         VerticalAlignment="Stretch"
                         MinHeight="200"
                         FontFamily="Consolas"
                         FontSize="11"
                         Background="Black"
                         Foreground="LimeGreen" />
            </ScrollViewer>
        </GroupBox>
        
    </DockPanel>
</base:WindowBase>
